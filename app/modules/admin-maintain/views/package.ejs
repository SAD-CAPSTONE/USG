 <%- include('../../../templates/admin-navbar.ejs') -%>


  <!-- Content Wrapper. Contains page content -->

 <div class="content-wrapper">
     <!-- Content Header (Page header) -->
     <section class="content-header">
       <h1>

         <small>Note: Please monitor stocks regularly, check if there is damaged products.</small>
       </h1>
       <ol class="breadcrumb">
         <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
         <li><a href="#">Maintenance</a></li>
         <li class="active">Package Discounts</li>
       </ol>
     </section>

     <!-- Main content -->
     <section class="content">
       <div class="row">
         <div class="col-xs-12">
           <div class="box">
             <div class="box-header">
               <h4 align="center">Package Discounts</h4>
             </div>
 			<!-- buttons -->
 				&nbsp; &nbsp;<button type="button" class="large ui green button" data-toggle="modal" data-target="#addPackage"><i class="fa fa-plus"></i> Add New Package</button>
             <!-- /.box-header -->
             <div class="box-body table-responsive">
               <table id="example2" class="table table-bordered table-hover">
                 <thead>
                 <tr>

                   <th>Package Name</th>
                   <th>Price</th>
                   <th>Date Created</th>
                   <th>Date Due</th>
 				           <th>Status</th>
                   <th>Actions</th>
                 </tr>
                 </thead>
                 <tbody>

                <% if (re == null || re == undefined){ %>

                <% }else if (re.length == 0){ %>

                <% }else{ %>
                <%  re.forEach(function(i){ %>
                    <tr>

                      <td><%=i.strPackageName%></td>
                      <td>Php <%= i.packagePrice.toFixed(2)%></td>
                      <td><%= moment(i.dateCreated).format("MM/DD/YYYY") %></td>
                      <td><%= moment(i.dateDue).format("MM/DD/YYYY") %></td>
                      <td>
                        <% if (i.intStatus==1){ %>
                          <button data-no="<%=i.intPackageNo%>" class="ui toggle button active inactivate_package">Active</button>

                        <% }else{ %>
                          <button data-no="<%=i.intPackageNo%>" class="ui toggle button inactive activate_package">Inactive</button>

                        <% } %>
                      </td>
                      <td>
                        <a href=""><button class="btn btn-default btn-xs">Description</button></a>
                        <a href=""><button class="btn btn-default btn-xs">Edit Details</button></a>
                        <a href="/maintenance/packageList?package=<%=i.intPackageNo%>"><button class="btn btn-primary btn-xs">Product List</button></a>

                      </td>
                    </tr>
                <%  }) %>
                <% } %>


                 </tbody>

               </table>
             </div>
             <!-- /.box-body -->
           </div>
           <!-- /.box -->

 	    </div>
         <!-- /.col -->
       </div>
       <!-- /.row -->
     </section>
     <!-- /.content -->
 </div>

   <!-- /.content-wrapper -->

 	<!-- Modals -->

 	<div class="modal fade" id="addPackage">
 	  <div class="modal-dialog">
 		<div class="modal-content">
 		  <div class="modal-header">
 			<button type="button" class="close" data-dismiss="modal" aria-label="Close">
 			  <span aria-hidden="true">&times;</span></button>
 			<h4 class="modal-title">Package Information Form</h4>
 		  </div>
 		  <div class="modal-body">
 			<!-- Horizontal Form -->

 					<!-- form start -->
          <form role="form">
              <div class="box-body">
                <div class="form-group">
                  <label for="pname">Package Name:</label>
                  <input type="text" required class="form-control" id="pname" placeholder="">
                </div>

                <div class="form-group">
                  <label for="pdesc">Package Description:</label>
                  <textarea class="form-control" id="pdesc" placeholder=""></textarea>
                </div>

                <div class="form-group">
                  <label for="pname">Package Quantity:</label>
                  <input type="number" required class="form-control" id="pquantity" >
                </div>

                <div class="form-group">
                  <label for="pprice">Package Price</label>
                  <input type="number" required class="form-control" id="pprice" placeholder="**change to input mask">
                  <small>this will be the price of the products included.</small>
                </div>

                <div class="form-group">
                  <label for="pdue">Due Date</label>
                  <input type="date" required class="form-control" id="pdue" >

                </div>

              </div>
            </form>

 			  </div>
 			  <div class="modal-footer">
 				<button type="button" class="btn btn-default pull-left" data-dismiss="modal">Close</button>
 				<button type="button" id="save" class="btn btn-primary">Save changes</button>
 			  </div>
 		</div>
 		<!-- /.modal-content -->
 	</div>
   <!-- /.modal-dialog -->
 </div>


 <%- include('../../../templates/admin-aside.ejs') -%>

 <!-- ./wrapper -->

 <!-- REQUIRED JS SCRIPTS -->

<%- include('../../../templates/admin-footer.ejs') -%>

 <!-- page script (new added) -->
 <script>
   $(function () {
     $('#example2').DataTable({
       'paging'      : true,
       'lengthChange': true,
       'searching'   : true,
       'ordering'    : true,
       'info'        : true,
       'autoWidth'   : true,
 	  'select'		: true,
 	  'scroll'		: true
     })
   })
 </script>

 <script>
 $(document).ready(function(i){
   $('#save').on('click',function(){
     $.ajax({
       url: '/maintenance/addPackage',
       method: 'post',
       datatype: "json",
       data: {
         pname: $('#pname').val(),
         pdesc: $('#pdesc').val(),
         pprice: $('#pprice').val(),
         pdue: $('#pdue').val(),
         pquantity: $('#pquantity').val()
       },
       success: function(response,status,http){
         if (response == "yes"){
           swal({title:"Success!", text:"You've added the package", type:"success"}).then(()=>{
             window.location.reload();

           });
         }else{

         }
       }
     })
   })
 })
 </script>

 <script>
 $('#title').html("USG | Package Discounts");
 $(".treeview a:contains('Maintenance')").parent().addClass("active");
 $(".navi a:contains('Package')").parent().addClass("active");
 </script>

 <script>
 $('.inactivate_package').on('click',function(){
   $(this).removeClass("ui toggle button active inactivate_package").addClass("ui toggle button  activate_package").html("Inactive");

   $.ajax({
     url: '/maintenance/inactivatePackage',
     method: 'post',
     datatype: 'json',
     data: {no: $(this).data('no')},
     success: function(response,status,http){
       if (response){
         swal("Success!", "You have activated Package no"+$(this).data('no'), "success");
       }
     }
   })
 })

 $('.activate_package').on('click',function(){
   $(this).removeClass("ui toggle button activate_package").addClass("ui toggle button active inactivate_package").html("Active");

   $.ajax({
     url: '/maintenance/activatePackage',
     method: 'post',
     datatype: 'json',
     data: {no: $(this).data('no')},
     success: function(response,status,http){
       if (response){
         swal("Success!", "You have activated Package no"+$(this).data('no'), "success");
       }
     }
   })
 })
 </script>


 <!-- Optionally, you can add Slimscroll and FastClick plugins.
      Both of these plugins are recommended to enhance the
      user experience. -->
 </body>
 </html>
