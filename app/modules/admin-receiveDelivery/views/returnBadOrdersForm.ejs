<%- include('../../../templates/admin-navbar.ejs') -%>


 <!-- Content Wrapper. Contains page content -->

<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <h1>

        <small></small>
      </h1>
      <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
        <li><a href="#">Transaction</a></li>
        <li class="active">Return Bad Orders</li>
      </ol>
    </section>

    <!-- Main content -->
    <section class="content">

    <form id="returnForm">

    <div class="box box-success">
			<div class="box-header with-border">
				<h3 class="box-title">Return Bad Orders Form</h3>
			</div>

			<!-- purchase order body -->
			<div class="box-body">

				<small><b>Business Address:</b> 0002 G/F Elizabeth Hall BLDG. 371 Katipunan Ave., Loyola Heights </br>
				Quezon City 1108</small> </br>
				<small><b>Phone Number:</b> (02) 738-1202</small> </br>
				<small><b>Mobile Number:</b> (0955) 904-4744</small> </br>
				</br>

				<div class="row">
					<div class="col-sm-4">
						<div class="form-group">
							<label for="purcNo">Receive Order Number:</label>

              <input type="text" value="<%= delivery_no  %>" name="rno" class="form-control">
						</div>
					</div>

					<div class="col-sm-2">
					</div>

					<div class="col-sm-4">

						<div class="form-group">
							<label for="purcNo">Return Order Date:</label>

							<input type="date" disabled value="<%= moment().format("YYYY-MM-DD") %>" class="form-control">
						</div>
					</div>
				</div>

      </br>


				<div class="row">
					<div class="col-sm-3">
						<h4> &nbsp;  </h4>
					</div>
				</div>

				<div class="row">
					<div class="col-sm-12">
					<div class="box">
						<div class="box-header">
						  <h3 class="box-title">Bad Orders List</h3>
						</div>

						<!-- buttons -->
						&nbsp; &nbsp;<button type="button" id="addButton"  class="addRow small ui green button" ><i class="fa fa-plus"></i> Add Product</button>

						<!-- /.box-header -->
						<div id="deliveryList" class="box-body table-responsive">
              <table id="example2" class="table table-bordered table-hover">
                <thead>


                  <th>Product Name</th>
                  <th>Variant (if any)</th>
                  <th>Size</th>
                  <th>Quantity</th>
                  <th>Expiration Date</th>
                  <th>Status</th>
                  <th>SRP</th>


                </thead>
                <tbody>
                  <% if(bad == null || bad == undefined){ %>

                  <% }else if(bad.length == 0){ %>

                  <% }else{ %>
                  <%  bad.forEach(function(i){ %>
                    <td><input type="text" name="product[]" class="form-control" value="<%=i.strProduct%>"></td>
                    <td><input type="text" name="variant[]" class="form-control" value="<%=i.strVariant%>"></td>
                    <td><input type="text" name="size[]" class="form-control" value="<%=i.strSize%>"></td>
                    <td><input type="number" name="quantity[]" class="form-control" value="<%=i.intQuantity%>"></td>
                    <td><input type="date" name="expiration[]" class="form-control" value="<%=moment(i.dateExpiration).format("YYYY-MM-DD")%>"></td>
                    <td><input type="text" disabled class="form-control" value="Bad"></td>
                    <td><input type="text" name="srp[]" class="form-control" value="<%=i.SRP%>"></td>
                  <% }) %>
                  <% } %>

                </tbody>

              </table>
						</div>
						<!-- /.box-body -->

					</div>
					  <!-- /.box -->
					</div>
				</div>



      </br>
    </br>
        <div class="row">
          <div class="col-sm-10">
            <label for="note">Why would you want to return the products?</label>
            <textarea class="form-control" id="reason" name="reason"></textarea>
          </div>
        </div>

			</div>

			<div class="box-footer">
          <a href="/receiveDelivery"><button type="button" class="large ui button">Back</button></a>
          <button  id="sub" type="submit" class="large ui teal button">Submit Form</button>
      </div>
              <!-- /.box-footer -->

		</div>

  </form>

	</section>

</div>

  <!-- /.content-wrapper -->



  <!-- Main Footer -->
  <footer class="main-footer">
    <!-- To the right -->
    <div class="pull-right hidden-xs">
      Anything you want
    </div>
    <!-- Default to the left -->
    <strong>Copyright &copy; 2016 <a href="#">Company</a>.</strong> All rights reserved.
  </footer>

  <!-- Control Sidebar -->
  <aside class="control-sidebar control-sidebar-dark">
    <!-- Create the tabs -->
    <ul class="nav nav-tabs nav-justified control-sidebar-tabs">
      <li class="active"><a href="#control-sidebar-home-tab" data-toggle="tab"><i class="fa fa-home"></i></a></li>
      <li><a href="#control-sidebar-settings-tab" data-toggle="tab"><i class="fa fa-gears"></i></a></li>
    </ul>
    <!-- Tab panes -->
    <div class="tab-content">
      <!-- Home tab content -->
      <div class="tab-pane active" id="control-sidebar-home-tab">
        <h3 class="control-sidebar-heading">Recent Activity</h3>
        <ul class="control-sidebar-menu">
          <li>
            <a href="javascript:;">
              <i class="menu-icon fa fa-birthday-cake bg-red"></i>

              <div class="menu-info">
                <h4 class="control-sidebar-subheading">Langdon's Birthday</h4>

                <p>Will be 23 on April 24th</p>
              </div>
            </a>
          </li>
        </ul>
        <!-- /.control-sidebar-menu -->

        <h3 class="control-sidebar-heading">Tasks Progress</h3>
        <ul class="control-sidebar-menu">
          <li>
            <a href="javascript:;">
              <h4 class="control-sidebar-subheading">
                Custom Template Design
                <span class="pull-right-container">
                    <span class="label label-danger pull-right">70%</span>
                  </span>
              </h4>

              <div class="progress progress-xxs">
                <div class="progress-bar progress-bar-danger" style="width: 70%"></div>
              </div>
            </a>
          </li>
        </ul>
        <!-- /.control-sidebar-menu -->

      </div>
      <!-- /.tab-pane -->
      <!-- Stats tab content -->
      <div class="tab-pane" id="control-sidebar-stats-tab">Stats Tab Content</div>
      <!-- /.tab-pane -->
      <!-- Settings tab content -->
      <div class="tab-pane" id="control-sidebar-settings-tab">
        <form method="post">
          <h3 class="control-sidebar-heading">General Settings</h3>

          <div class="form-group">
            <label class="control-sidebar-subheading">
              Report panel usage
              <input type="checkbox" class="pull-right" checked>
            </label>

            <p>
              Some information about this general settings option
            </p>
          </div>
          <!-- /.form-group -->
        </form>
      </div>
      <!-- /.tab-pane -->
    </div>
  </aside>
  <!-- /.control-sidebar -->
  <!-- Add the sidebar's background. This div must be placed
  immediately after the control sidebar -->
  <div class="control-sidebar-bg"></div>
</div>
<!-- ./wrapper -->

<!-- REQUIRED JS SCRIPTS -->

<%- include('../../../templates/admin-footer.ejs') -%>

<!-- page script (new added) -->


<script>
  $(function () {
    $('#example2').DataTable({
      'paging'      : false,
      'lengthChange': false,
      'info'        : false,
      'autoWidth'   : true,
      'searching'   : false,
      'ordering'    : false

    })
  })
</script>



<script>

  var count = 1;
    $('.addRow').on( 'click', function () {
      var t = $('#example2').DataTable();
      var table = document.getElementById("example2");
      var row = table.getElementsByTagName("tr");
      var rows = t.rows( '.selected' );
      var tr = table.getElementsByTagName("tr");
      var validity = 1;


      if (validity){
        t.row.add( [
            '<input  required type="text" required name="product[]" value="" class="form-control">',
            '<input  required type="text" name="variant[]" value="" class="form-control">',
            '<input  type="text" name="size[]" value="" class="form-control">',
            '<input  type="number" required name="quantity[]" value="" class=" form-control">',
            '<input type="date" required name="expiration[]"  class=" form-control">',
            '<input type="text" disabled required value="Bad"  class=" form-control">',
            '<input  type="text" name="srp[]" value="" class=" form-control">'

        ] ).draw( false );

        count++;
      }
    } );

</script>


<script>
$('#title').html("USG | Receive Delivery");
$(".treeview a:contains('Transactions')").parent().addClass("active");
$(".navi a:contains('Receive Delivery')").parent().addClass("active");
</script>

<script>
  //Flat red color scheme for iCheck
  $('input[type="checkbox"].flat-red, input[type="radio"].flat-red').iCheck({
    checkboxClass: 'icheckbox_flat-green',
    radioClass   : 'iradio_flat-green'
  })
</script>

<script>
  $('#returnForm').submit(function(e){
    e.preventDefault();
    swal({
      title: "Are you sure?",
      text: "Please review products before proceeding",
      type: "warning",
      showCancelButton: true,
      confirmButtonClass: "btn-warning",
      confirmButtonText: "Yes, proceed",
      cancelButtonText: "Cancel",
      closeOnConfirm: true,
      closeOnCancel: true
    },
    function(isConfirm){
      if(isConfirm){
        $.post('/receiveDelivery/returnBadOrders',$('#returnForm').serialize(),function(response,status){
          if(response == "yes"){
            swal({title: "Success!", text:"You can view list of products you returned to supplier", type:"success"},
              function(){
                location.reload();
            });
          }else{
            swal({title: "Error!", text:"", type:"error"},
              function(){

            });
          }
        })
      }


    })
  })
</script>




<!-- Optionally, you can add Slimscroll and FastClick plugins.
     Both of these plugins are recommended to enhance the
     user experience. -->
</body>
</html>
